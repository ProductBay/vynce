// POST /api/make-call -> dial requested number
app.post("/api/make-call", async (req, res) => {
  const to = req.body.to;
  if (!to) return res.status(400).json({ success: false, message: "Missing number" });

  try {
    const entry = await initiateCall(to);
    res.json({ success: true, data: entry });
  } catch (err) {
    res.status(500).json({ success: false, message: err.message });
  }
});

app.get("/api/calls", (req, res) => {
  // Return all calls (sorted by newest first)
  const sortedCalls = allCalls.sort((a, b) => {
    return new Date(b.createdAt) - new Date(a.createdAt)
  })
  
  console.log(`ðŸ“Š API /calls requested: ${sortedCalls.length} calls`)
  res.json(sortedCalls)
})